(function(root,factory){if(typeof define==='function'&&define.amd){define("game",[],factory);}else if(typeof exports!=='undefined'){module.exports=factory();if(typeof window==='undefined'){root.game=module.exports;}}else{root.game=factory();}}(this,function(){"use strict";var _pyfunc_format=function(v,fmt){fmt=fmt.toLowerCase();var s=String(v);if(fmt.indexOf('!r')>=0){try{s=JSON.stringify(v);}catch(e){s=undefined;}
if(typeof s==='undefined'){s=v._IS_COMPONENT?v.id:String(v);}}
var fmt_type='';if(fmt.slice(-1)=='i'||fmt.slice(-1)=='f'||fmt.slice(-1)=='e'||fmt.slice(-1)=='g'){fmt_type=fmt[fmt.length-1];fmt=fmt.slice(0,fmt.length-1);}
var i0=fmt.indexOf(':');var i1=fmt.indexOf('.');var spec1='',spec2='';if(i0>=0){if(i1>i0){spec1=fmt.slice(i0+1,i1);spec2=fmt.slice(i1+1);}
else{spec1=fmt.slice(i0+1);}}
if(fmt_type==''){}else if(fmt_type=='i'){s=parseInt(v).toFixed(0);}else if(fmt_type=='f'){v=parseFloat(v);var decimals=spec2?Number(spec2):6;s=v.toFixed(decimals);}else if(fmt_type=='e'){v=parseFloat(v);var precision=(spec2?Number(spec2):6)||1;s=v.toExponential(precision);}else if(fmt_type=='g'){v=parseFloat(v);var precision=(spec2?Number(spec2):6)||1;s=v.toExponential(precision-1);var s1=s.slice(0,s.indexOf('e')),s2=s.slice(s.indexOf('e'));if(s2.length==3){s2='e'+s2[1]+'0'+s2[2];}
var exp=Number(s2.slice(1));if(exp>=-4&&exp<precision){s1=v.toPrecision(precision);s2='';}
var j=s1.length-1;while(j>0&&s1[j]=='0'){j-=1;}
s1=s1.slice(0,j+1);if(s1.slice(-1)=='.'){s1=s1.slice(0,s1.length-1);}
s=s1+s2;}
var prefix='';if(spec1){if(spec1[0]=='+'&&v>0){prefix='+';spec1=spec1.slice(1);}
else if(spec1[0]==' '&&v>0){prefix=' ';spec1=spec1.slice(1);}}
if(spec1&&spec1[0]=='0'){var padding=Number(spec1.slice(1))-(s.length+prefix.length);s='0'.repeat(Math.max(0,padding))+s;}
return prefix+s;};var _pyfunc_op_add=function(a,b){if(Array.isArray(a)&&Array.isArray(b)){return a.concat(b);}return a+b;};var _pyfunc_op_contains=function op_contains(a,b){if(b==null){}else if(Array.isArray(b)){for(var i=0;i<b.length;i++){if(_pyfunc_op_equals(a,b[i]))
return true;}
return false;}else if(b.constructor===Object){for(var k in b){if(a==k)return true;}
return false;}else if(b.constructor==String){return b.indexOf(a)>=0;}var e=Error('Not a container: '+b);e.name='TypeError';throw e;};var _pyfunc_op_equals=function op_equals(a,b){var a_type=typeof a;if(a_type==="string"||a_type==="boolean"||a_type==="number"){return a==b;}
if(a==null||b==null){}else if(Array.isArray(a)&&Array.isArray(b)){var i=0,iseq=a.length==b.length;while(iseq&&i<a.length){iseq=op_equals(a[i],b[i]);i+=1;}
return iseq;}else if(a.constructor===Object&&b.constructor===Object){var akeys=Object.keys(a),bkeys=Object.keys(b);akeys.sort();bkeys.sort();var i=0,k,iseq=op_equals(akeys,bkeys);while(iseq&&i<akeys.length)
{k=akeys[i];iseq=op_equals(a[k],b[k]);i+=1;}
return iseq;}return a==b;};var _pyfunc_op_instantiate=function(ob,args){if((typeof ob==="undefined")||(typeof window!=="undefined"&&window===ob)||(typeof global!=="undefined"&&global===ob))
{throw"Class constructor is called as a function.";}
for(var name in ob){if(Object[name]===undefined&&typeof ob[name]==='function'&&!ob[name].nobind){ob[name]=ob[name].bind(ob);ob[name].__name__=name;}}
if(ob.__init__){ob.__init__.apply(ob,args);}};var _pymeth_append=function(x){if(!Array.isArray(this))return this.append.apply(this,arguments);this.push(x);};var _pymeth_format=function(){if(this.constructor!==String)return this.format.apply(this,arguments);var parts=[],i=0,i1,i2;var itemnr=-1;while(i<this.length){i1=this.indexOf('{',i);if(i1<0||i1==this.length-1){break;}
if(this[i1+1]=='{'){parts.push(this.slice(i,i1+1));i=i1+2;continue;}
i2=this.indexOf('}',i1);if(i2<0){break;}
itemnr+=1;var fmt=this.slice(i1+1,i2);var index=fmt.split(':')[0].split('!')[0];index=index?Number(index):itemnr
var s=_pyfunc_format(arguments[index],fmt);parts.push(this.slice(i,i1),s);i=i2+1;}
parts.push(this.slice(i));return parts.join('');};var Board,Cell,Game,count2d,game;count2d=function flx_count2d(arr,value){var cell,line,stub1_seq,stub2_itr,stub3_seq,stub4_itr,summ;summ=0;stub3_seq=arr;if((typeof stub3_seq==="object")&&(!Array.isArray(stub3_seq))){stub3_seq=Object.keys(stub3_seq);}
for(stub4_itr=0;stub4_itr<stub3_seq.length;stub4_itr+=1){line=stub3_seq[stub4_itr];stub1_seq=line;if((typeof stub1_seq==="object")&&(!Array.isArray(stub1_seq))){stub1_seq=Object.keys(stub1_seq);}
for(stub2_itr=0;stub2_itr<stub1_seq.length;stub2_itr+=1){cell=stub1_seq[stub2_itr];if(_pyfunc_op_equals(cell,value)){summ+=1;}}}
return summ;};Cell=function(){_pyfunc_op_instantiate(this,arguments);}
Cell.prototype._base_class=Object;Cell.prototype.__name__="Cell";Cell.prototype.__init__=function(board,y,x){this.board=board;this.y=y;this.x=x;this.node=document.createElement("div");this.board.node.appendChild(this.node);this.node.cell=this;this.team=0;this.selected=false;this.locked=false;this.node.onmouseover=this.onmouseover;this.node.onmouseout=this.onmouseout;this.node.onclick=this.onclick;return null;};Cell.prototype.neighbours=function(){var cells,n,nx,ny,stub5_seq,stub6_itr,stub7_seq,stub8_itr,x,y;cells=this.board.cells;n=[[null,null,null],[null,null,null],[null,null,null]];stub7_seq=[-1,0,+1];if((typeof stub7_seq==="object")&&(!Array.isArray(stub7_seq))){stub7_seq=Object.keys(stub7_seq);}
for(stub8_itr=0;stub8_itr<stub7_seq.length;stub8_itr+=1){y=stub7_seq[stub8_itr];stub5_seq=[-1,0,+1];if((typeof stub5_seq==="object")&&(!Array.isArray(stub5_seq))){stub5_seq=Object.keys(stub5_seq);}
for(stub6_itr=0;stub6_itr<stub5_seq.length;stub6_itr+=1){x=stub5_seq[stub6_itr];nx=_pyfunc_op_add(this.x,x);ny=_pyfunc_op_add(this.y,y);if(((nx>=0)&&((nx<=(this.board.SIZE-1)))&&(ny>=0)&&((ny<=(this.board.SIZE-1))))){n[y+1][x+1]=(cells[ny][nx]).team;}}}
n[1][1]=null;return n;};Cell.prototype.set_color=function(color){this.node.style.backgroundColor=color;return null;};Cell.prototype.onmouseover=function(event){if(_pyfunc_op_equals(this.team,0)){this.locked=false;}
if(_pyfunc_op_equals(this.locked,false)){if(_pyfunc_op_equals(this.team,0)){this.set_color("yellow");}else if(_pyfunc_op_equals(this.team,1)){this.set_color("orange");}else if(_pyfunc_op_equals(this.team,2)){this.set_color("green");}}
return null;};Cell.prototype.onmouseout=function(event){if(_pyfunc_op_equals(this.team,0)){this.set_color("white");}else if(_pyfunc_op_equals(this.team,1)){if(_pyfunc_op_equals(this.locked,false)){this.set_color("red");}else{this.set_color("#800");}}else if(_pyfunc_op_equals(this.team,2)){if(_pyfunc_op_equals(this.locked,false)){this.set_color("blue");}else{this.set_color("#008");}}
if((_pyfunc_op_equals(this.team,1)&&_pyfunc_op_equals(this.selected,true))){this.set_color("orange");}else if((_pyfunc_op_equals(this.team,2)&&_pyfunc_op_equals(this.selected,true))){this.set_color("green");}
return null;};Cell.prototype.onclick=function(event){var i,j,stub10_itr,stub11_seq,stub12_itr,stub13_seq,stub14_itr,stub15_seq,stub16_itr,stub9_seq;if(_pyfunc_op_equals(game.state,0)){this.team+=1;if((this.team>2)){this.team=0;}}
if(_pyfunc_op_equals(game.state,1)){if((!_pyfunc_op_equals(this.team,0))){if((!_pyfunc_op_equals([this.x,this.y],game.has_moved))){if(_pyfunc_op_equals(this.locked,false)){if((_pyfunc_op_equals(this.selected,false)&&_pyfunc_op_equals(this.team,game.turn[0]))){stub11_seq=game.board.cells;if((typeof stub11_seq==="object")&&(!Array.isArray(stub11_seq))){stub11_seq=Object.keys(stub11_seq);}
for(stub12_itr=0;stub12_itr<stub11_seq.length;stub12_itr+=1){j=stub11_seq[stub12_itr];stub9_seq=j;if((typeof stub9_seq==="object")&&(!Array.isArray(stub9_seq))){stub9_seq=Object.keys(stub9_seq);}
for(stub10_itr=0;stub10_itr<stub9_seq.length;stub10_itr+=1){i=stub9_seq[stub10_itr];i.selected=false;i.node.onmouseout();}}
this.selected=true;}else if(_pyfunc_op_equals(this.selected,true)){this.selected=false;}}}}else if(_pyfunc_op_equals(this.team,0)){stub15_seq=game.board.cells;if((typeof stub15_seq==="object")&&(!Array.isArray(stub15_seq))){stub15_seq=Object.keys(stub15_seq);}
for(stub16_itr=0;stub16_itr<stub15_seq.length;stub16_itr+=1){j=stub15_seq[stub16_itr];stub13_seq=j;if((typeof stub13_seq==="object")&&(!Array.isArray(stub13_seq))){stub13_seq=Object.keys(stub13_seq);}
for(stub14_itr=0;stub14_itr<stub13_seq.length;stub14_itr+=1){i=stub13_seq[stub14_itr];if(_pyfunc_op_equals(i.selected,true)){if((_pyfunc_op_contains(i.x,[this.x+1,this.x,this.x-1])&&_pyfunc_op_contains(i.y,[this.y+1,this.y,this.y-1]))){i.selected=false;this.team=i.team;i.team=0;i.locked=false;game.turn[1]+=1;if((game.turn[1]>=2)){if(_pyfunc_op_equals(game.turn[0],1)){game.turn[0]=2;game.node=document.querySelector("body");game.node.style.background="lightblue";}else if(_pyfunc_op_equals(game.turn[0],2)){game.turn[0]=1;game.node=document.querySelector("body");game.node.style.background="pink";}
game.turn[1]=0;game.end_turn();}
game.has_moved=[this.x,this.y];i.node.onmouseout();}else if(_pyfunc_op_equals([i.x,i.y],[this.x,this.y-2])){console.log("N");if((((!(_pyfunc_op_equals(i.team,((game.board.cells[this.y-1][this.x]).team)))))&&((!(_pyfunc_op_equals(0,((game.board.cells[this.y-1][this.x]).team))))))){i.selected=false;this.team=i.team;i.team=0;i.locked=false;game.turn[1]+=1;if((game.turn[1]>=2)){if(_pyfunc_op_equals(game.turn[0],1)){game.turn[0]=2;game.node=document.querySelector("body");game.node.style.background="lightblue";}else if(_pyfunc_op_equals(game.turn[0],2)){game.turn[0]=1;game.node=document.querySelector("body");game.node.style.background="pink";}
game.turn[1]=0;game.end_turn();}
game.has_moved=[this.x,this.y];(game.board.cells[this.y-1][this.x]).team=0;((game.board.cells[this.y-1][this.x]).set_color)("white");i.node.onmouseout();}}else if(_pyfunc_op_equals([i.x,i.y],[this.x+2,this.y])){console.log("O");if((((!(_pyfunc_op_equals(i.team,((game.board.cells[this.y][this.x+1]).team)))))&&((!(_pyfunc_op_equals(0,((game.board.cells[this.y][this.x+1]).team))))))){i.selected=false;this.team=i.team;i.team=0;i.locked=false;game.turn[1]+=1;if((game.turn[1]>=2)){if(_pyfunc_op_equals(game.turn[0],1)){game.turn[0]=2;game.node=document.querySelector("body");game.node.style.background="lightblue";}else if(_pyfunc_op_equals(game.turn[0],2)){game.turn[0]=1;game.node=document.querySelector("body");game.node.style.background="pink";}
game.turn[1]=0;game.end_turn();}
game.has_moved=[this.x,this.y];(game.board.cells[this.y][this.x+1]).team=0;((game.board.cells[this.y][this.x+1]).set_color)("white");i.node.onmouseout();}}else if(_pyfunc_op_equals([i.x,i.y],[this.x,this.y+2])){console.log("S");if((((!(_pyfunc_op_equals(i.team,((game.board.cells[this.y+1][this.x]).team)))))&&((!(_pyfunc_op_equals(0,((game.board.cells[this.y+1][this.x]).team))))))){i.selected=false;this.team=i.team;i.team=0;i.locked=false;game.turn[1]+=1;if((game.turn[1]>=2)){if(_pyfunc_op_equals(game.turn[0],1)){game.turn[0]=2;game.node=document.querySelector("body");game.node.style.background="lightblue";}else if(_pyfunc_op_equals(game.turn[0],2)){game.turn[0]=1;game.node=document.querySelector("body");game.node.style.background="pink";}
game.turn[1]=0;game.end_turn();}
game.has_moved=[this.x,this.y];(game.board.cells[this.y+1][this.x]).team=0;((game.board.cells[this.y+1][this.x]).set_color)("white");i.node.onmouseout();}}else if(_pyfunc_op_equals([i.x,i.y],[this.x-2,this.y])){console.log("W");if((((!(_pyfunc_op_equals(i.team,((game.board.cells[this.y][this.x-1]).team)))))&&((!(_pyfunc_op_equals(0,((game.board.cells[this.y][this.x-1]).team))))))){i.selected=false;this.team=i.team;i.team=0;i.locked=false;game.turn[1]+=1;if((game.turn[1]>=2)){if(_pyfunc_op_equals(game.turn[0],1)){game.turn[0]=2;game.node=document.querySelector("body");game.node.style.background=_pymeth_format.call("lightblue");}else if(_pyfunc_op_equals(game.turn[0],2)){game.turn[0]=1;game.node=document.querySelector("body");game.node.style.background="pink";}
game.turn[1]=0;game.end_turn();}
game.has_moved=[this.x,this.y];(game.board.cells[this.y][this.x-1]).team=0;((game.board.cells[this.y][this.x-1]).set_color)("white");i.node.onmouseout();}}}}}}}
return null;};Board=function(){_pyfunc_op_instantiate(this,arguments);}
Board.prototype._base_class=Object;Board.prototype.__name__="Board";Board.prototype.SIZE=32;Board.prototype.__init__=function(){var row,x,y;this.node=document.querySelector("body");this.node.style.background=_pymeth_format.call("lightgray");this.node=document.querySelector("#board");this.node.style.gridTemplateColumns=_pymeth_format.call("repeat({}, 1fr)",this.SIZE);this.cells=[];for(y=0;y<this.SIZE;y+=1){row=[];for(x=0;x<this.SIZE;x+=1){_pymeth_append.call(row,(new Cell(this,y,x)));}
_pymeth_append.call(this.cells,row);}
return null;};Game=function(){_pyfunc_op_instantiate(this,arguments);}
Game.prototype._base_class=Object;Game.prototype.__name__="Game";Game.prototype.__init__=function(){this.board=new Board();this.button_start_game=document.querySelector("#start_game");this.button_start_game.onclick=this.on_start_game;this.state=0;this.has_moved=null;this.turn=[0,0];return null;};Game.prototype.on_start_game=function(event){if(_pyfunc_op_equals(this.state,0)){this.state=1;this.turn=[1,0];game.node=document.querySelector("body");game.node.style.background="pink";}
console.log(this.state);return null;};Game.prototype.end_turn=function(){var cell,line,stub17_seq,stub18_itr,stub19_seq,stub20_itr;console.log("end_turn");stub19_seq=this.board.cells;if((typeof stub19_seq==="object")&&(!Array.isArray(stub19_seq))){stub19_seq=Object.keys(stub19_seq);}
for(stub20_itr=0;stub20_itr<stub19_seq.length;stub20_itr+=1){line=stub19_seq[stub20_itr];stub17_seq=line;if((typeof stub17_seq==="object")&&(!Array.isArray(stub17_seq))){stub17_seq=Object.keys(stub17_seq);}
for(stub18_itr=0;stub18_itr<stub17_seq.length;stub18_itr+=1){cell=stub17_seq[stub18_itr];if((!_pyfunc_op_equals(cell.team,0))){if(((count2d(cell.neighbours(),cell.team))<1)){cell.team=0;cell.locked=false;cell.set_color("white");}
if(_pyfunc_op_equals(cell.team,1)){if(((count2d(cell.neighbours(),2))>=4)){cell.team=0;cell.locked=false;cell.set_color("white");}else if((_pyfunc_op_equals((count2d(cell.neighbours(),2)),3))){cell.locked=true;cell.set_color("#800");}else{cell.locked=false;cell.set_color("red");}}else if(_pyfunc_op_equals(cell.team,2)){if(((count2d(cell.neighbours(),1))>=4)){cell.team=0;cell.locked=false;cell.set_color("white");}else if((_pyfunc_op_equals((count2d(cell.neighbours(),1)),3))){cell.locked=true;cell.set_color("#008");}else{cell.locked=false;cell.set_color("blue");}}}}}
return null;};Game.prototype.run=function(){console.log("running\u2026");return null;};game=new Game();game.run();return{count2d:count2d,Cell:Cell,game:game,Game:Game,Board:Board};}));